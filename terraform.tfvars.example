# Copy to terraform.tfvars — this file is gitignored (*.tfvars).
# Never commit terraform.tfvars or terraform.tfstate.

# ---- Cluster ---------------------------------------------------------------

cluster_name = "ethrc-prod-1"
region       = "us-east-1"

# ---- Nodes -----------------------------------------------------------------
# node_tier controls Karpenter NodePool selection and GPU Operator installation.
# cpu = CPU only (m5/m6i/t3, spot-eligible), gpum = g6e.4xlarge, gpul = p5.xlarge
node_tier = "cpu"

# Hard TTL for gpum/gpul nodes. Karpenter drains and terminates any node running
# longer than this, regardless of what's on it. Default: 24h. Set "Never" to disable.
# gpu_node_max_lifetime = "24h"

# ---- Access ----------------------------------------------------------------
# IAM user or role ARNs for per-user kubeconfig access (no shared credentials).
# Policies: AmazonEKSClusterAdminPolicy | AmazonEKSAdminPolicy
#           AmazonEKSEditPolicy         | AmazonEKSViewPolicy
#
# Add "namespaces" to restrict a principal to specific namespace(s) only.
# Omit "namespaces" (or leave it as []) for cluster-wide access (admins only).

cluster_access = {
  # Platform admin — cluster-wide access
  alice = {
    principal_arn = "arn:aws:iam::123456789012:user/alice"
    policy        = "AmazonEKSClusterAdminPolicy"
  }

  # Robot-learning team — kubectl access scoped to their namespace only
  rl-engineer = {
    principal_arn = "arn:aws:iam::123456789012:role/robot-learning-dev"
    policy        = "AmazonEKSEditPolicy"
    namespaces    = ["robot-learning"]
  }

  # Humanoid team — kubectl access scoped to their namespace only
  hum-engineer = {
    principal_arn = "arn:aws:iam::123456789012:role/humanoid-dev"
    policy        = "AmazonEKSEditPolicy"
    namespaces    = ["humanoid"]
  }
}

# ---- ArgoCD team access ----------------------------------------------------
# Maps each workload namespace to one or more SSO/OIDC group names.
# Members of these groups can deploy via ArgoCD into their namespace only.
# Leave empty ({}) to manage ArgoCD SSO group bindings outside Terraform.

argocd_team_groups = {
  robot-learning = ["okta-group-robot-learning", "github-team-robot-learning"]
  humanoid       = ["okta-group-humanoid"]
  aeronautics    = ["okta-group-aeronautics"]
  cybersecurity  = ["okta-group-cybersecurity"]
}

# ---- IPv6 ------------------------------------------------------------------
# Option A: AWS-provided IPv6 (default)
use_byoip_ipv6 = false

# Option B: BYOIP — see docs/IPv6 BYOIP.md
# use_byoip_ipv6     = true
# byoip_ipv6_pool_id = "ipv6pool-ec2-0123456789abcdef0"
# byoip_ipv6_cidr    = "2001:db8:1234::/56"

# ---- S3 CSI ----------------------------------------------------------------
# Uncomment and list the S3 buckets the cluster should be able to mount.
# Leave commented out (empty list is the default) to skip driver installation.
# s3_bucket_arns = [
#   "arn:aws:s3:::my-training-datasets",
#   "arn:aws:s3:::my-model-checkpoints",
# ]

# ---- Tags ------------------------------------------------------------------

tags = {
  Project     = "ethrc-prod-1"
  Environment = "production"
  ManagedBy   = "OpenTofu"
}
